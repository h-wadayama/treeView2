<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE configuration>
<!-- ======================================================================
     ブランクプロジェクトをビルドするスクリプト
     ====================================================================== -->
<project name="project" default="deploy" basedir="..">

    <!-- プロパティの読み込み -->
    <property file="./build/build.properties" />

    <!-- クラスパスの設定 -->
    <property name="classpath.lib" value="
        ${lib.dir}/antlr-2.7.6.jar;
    	${lib.dir}/aopalliance-1.0.jar;
    	${lib.dir}/hibernate-validator-4.3.1.Final.jar;
        ${webapsvr.lib.dir}/servlet-api.jar;
        ${lib.dir}/aspectjweaver-1.7.4.jar;
        ${lib.dir}/commons-beanutils-1.8.3.jar;
        ${lib.dir}/commons-digester-2.0.jar;
        ${lib.dir}/commons-fileupload-1.3.2.jar;
        ${lib.dir}/commons-io-2.4.jar;
        ${lib.dir}/commons-jxpath-1.3.jar;
        ${lib.dir}/commons-lang-2.5.jar;
        ${lib.dir}/commons-logging-1.1.3.jar;
    	${lib.dir}/commons-lang3-3.1.jar;
        ${lib.dir}/commons-validator-1.3.1.jar;
        ${lib.dir}/jakarta-oro-2.0.8.jar;
        ${lib.dir}/log4j-1.2.16.jar;
        ${lib.dir}/mybatis-2.3.5.jar;
        ${lib.dir}/spring-aop-3.2.4.RELEASE.jar;
    	${lib.dir}/spring-aspects-3.2.4.RELEASE.jar;
        ${lib.dir}/spring-beans-3.2.4.RELEASE.jar;
        ${lib.dir}/spring-context-3.2.4.RELEASE.jar;
    	${lib.dir}/spring-context-support-3.2.4.RELEASE.jar;
        ${lib.dir}/spring-core-3.2.4.RELEASE.jar;
    	${lib.dir}/spring-data-commons-1.6.1.RELEASE.jar;
        ${lib.dir}/spring-expression-3.2.4.RELEASE.jar;
        ${lib.dir}/spring-jdbc-3.2.4.RELEASE.jar;
        ${lib.dir}/spring-orm-3.2.4.RELEASE.jar;
    	${lib.dir}/spring-security-acl-3.1.4.RELEASE.jar;
    	${lib.dir}/spring-security-config-3.1.4.RELEASE.jar;
    	${lib.dir}/spring-security-core-3.1.4.RELEASE.jar;
    	${lib.dir}/spring-security-taglibs-3.1.4.RELEASE.jar;
    	${lib.dir}/spring-security-web-3.1.4.RELEASE.jar;
        ${lib.dir}/spring-tx-3.2.4.RELEASE.jar;
        ${lib.dir}/spring-web-3.2.4.RELEASE.jar;
    	${lib.dir}/terasoluna-gfw-common-1.0.0.RELEASE.jar;
    	${lib.dir}/terasoluna-gfw-security-core-1.0.0.RELEASE.jar;
    	${lib.dir}/terasoluna-gfw-security-web-1.0.0.RELEASE.jar;
    	${lib.dir}/terasoluna-thin-2.0.6.1.jar;
    	${lib.dir}/validation-api-1.0.0.GA.jar;
    	${lib.dir}/ojdbc6.jar;
    	${lib.dir}/slf4j-api-1.7.5.jar;
    	${lib.dir}/jackson-annotations-2.11.0.jar;
    	${lib.dir}/jackson-core-2.11.0.jar;
    	${lib.dir}/jackson-databind-2.11.0.jar;
    	${lib.dir}/terasoluna-gfw-web-1.0.0.RELEASE.jar; "/>



    <!-- =================================
          Warファイル、コンパイルされたクラスファイルの削除を行う。
       ================================= -->
    <target name="clean" description="war、クラスファイルの削除">
        <delete file="${deploy.dir}/${context.name}.war" failonerror="false" />
        <delete includeEmptyDirs="true" failonerror="false">
            <fileset dir="${web.inf.dir}/classes" includes="**/*" />
        </delete>
    	<delete dir="${deploy.dir}/${context.name}" />
    </target>

    <!-- =================================
          コンパイルを行う。
       ================================= -->
    <target name="compile" depends="clean" description="コンパイル実行">
        <mkdir dir="${web.inf.dir}/classes" />
        <javac includeantruntime="false" srcdir="${source.dir}" destdir="${web.inf.dir}/classes" classpath="${classpath.lib}" debug="on" />
        <copy todir="${web.inf.dir}/classes">
            <fileset dir="${source.dir}">
                <include name="**/*.xml" />
            </fileset>
        </copy>
    </target>

    <!-- =================================
          native2asciiにてプロパティファイルのコード変換を行う。
       ================================= -->
    <target name="native2ascii" depends="compile" description="プロパティファイルのコード変換">
        <delete file="${web.inf.dir}/classes">
            <include name="*.properties" />
        </delete>
        <native2ascii encoding="Windows-31J" src="${source.dir}" dest="${web.inf.dir}/classes" includes="*.properties" ext=".properties" />
    </target>

    <!-- =================================
          プロジェクトのデプロイを行う。
       ================================= -->
    <target name="deploy" depends="native2ascii" description="デプロイ実行">
        <delete file="${deploy.dir}/${context.name}.war" failonerror="false" />
        <delete file="${context.name}.war" failonerror="false" />
        <jar jarfile="${context.name}.war" basedir="./WebContent" />
        <copy file="${context.name}.war" todir="${deploy.dir}" />
        <delete file="${context.name}.war" failonerror="false" />
    	<delete dir="${deploy.dir}/${context.name}" />
    </target>

    <!-- =================================
          JavaDocの生成を行う。
       ================================= -->
    <target name="createJavaDoc" description="JavaDoc生成">
        <delete dir="./doc/javadoc" />
        <mkdir dir="./doc/javadoc" />
        <javadoc classpath="${classpath.lib}" sourcepath="${source.dir}" destdir="./doc/javadoc" doctitle="${context.name}" windowtitle="${context.name}" use="true" splitindex="true" encoding="Windows-31J" private="true" packagenames="**/*">
        </javadoc>
    </target>
</project>
